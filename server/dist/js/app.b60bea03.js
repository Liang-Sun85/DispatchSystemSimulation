(function(t){function e(e){for(var a,o,r=e[0],l=e[1],c=e[2],u=0,h=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&h.push(s[o][0]),s[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);d&&d(e);while(h.length)h.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],a=!0,r=1;r<i.length;r++){var l=i[r];0!==s[l]&&(a=!1)}a&&(n.splice(e--,1),t=o(o.s=i[0]))}return t}var a={},s={app:0},n=[];function o(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=a,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(i,a,function(e){return t[e]}.bind(null,a));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=l;n.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";i("85ec")},1208:function(t,e,i){},2964:function(t,e,i){"use strict";i("c732")},"46f8":function(t,e,i){"use strict";i("e864")},"4b05":function(t,e,i){"use strict";i("ca91")},"4ef9":function(t,e,i){"use strict";i("79cd")},5331:function(t,e,i){"use strict";i("b6e1")},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var a=i("2b0e"),s=i("bc3a"),n=i.n(s),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},r=[],l={name:"app",components:{}},c=l,d=(i("034f"),i("2877")),u=Object(d["a"])(c,o,r,!1,null,null,null),h=u.exports,p=i("8c4f"),f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vehicles"},[i("div",{staticClass:"action-area"},[i("el-checkbox",{staticStyle:{color:"#cccccc"},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},[t._v("全选")]),i("el-divider",{attrs:{direction:"vertical"}}),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.pauseAll(!0)}}},[t._v("⼀键暂停")]),i("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.pauseAll(!1)}}},[t._v("⼀键恢复")]),i("el-divider",{attrs:{direction:"vertical"}}),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.pauseSelect(!0)}}},[t._v("暂停")]),i("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.pauseSelect(!1)}}},[t._v("恢复")]),i("el-divider",{attrs:{direction:"vertical"}}),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.withdrawSelect}},[t._v("撤销运单")]),i("el-divider",{attrs:{direction:"vertical"}})],1),i("el-divider"),i("div",{staticClass:"bot-list"},t._l(t.bots,(function(e,a){return i("bot-item",t._b({key:e.id,attrs:{selected:t.selectedMap.get(e.id)},on:{selectClick:function(e){return t.select(a)}},nativeOn:{dblclick:function(e){return t.greet(a)}}},"bot-item",e,!1))})),1),i("el-dialog",{attrs:{visible:t.centerDialogVisible,title:t.bots[t.selectedIndex].vehicle_id,center:"",width:"30%"},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[i("bot-item-extended",t._b({},"bot-item-extended",t.bots[t.selectedIndex],!1))],1)],1)},m=[],g=(i("4ec9"),i("d3b7"),i("3ca3"),i("ddb0"),i("159b"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bot_item"},[i("div",{staticClass:"bot_item_title"},[i("el-checkbox",{attrs:{value:t.self_selected},on:{change:function(e){return t.$emit("selectClick")}}}),i("span",{staticStyle:{"margin-left":"15px","font-size":"16px"}},[t._v(t._s(t.vehicle_id))])],1),i("table",{staticClass:"info_area"},[i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("电量")]),i("td",{attrs:{width:"65%"}},[i("el-progress",{attrs:{percentage:parseInt(100*t.battery_level),"stroke-width":16,color:t.batteryColors,"text-inside":!0}})],1)]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("在线状态")]),i("td",{attrs:{width:"65%"}},[t._v(t._s(t.onlineStatus))])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("运行状态")]),i("td",{attrs:{width:"65%"}},[t._v(t._s(t.taskStatus))])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("当前位置")]),i("td",{attrs:{width:"65%"}},[t._v(t._s(t.current_station))])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("运单")]),i("td",{attrs:{width:"65%"}},[t._v(t._s(t.current_order))])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("当前地图")]),i("td",{attrs:{width:"65%"}},[t._v(t._s(t.current_map))])])])])}),b=[],v=(i("a9e3"),{components:{},props:{status:{type:String,default:"offline"},vehicle_id:{type:String,default:""},current_station:{type:String,default:""},task_status:{type:Number,default:0},current_map:{type:String,default:""},battery_level:{type:Number,default:.8},current_order:{type:String,default:""},selected:{type:Boolean,default:!1}},data:function(){return{self_selected:!1}},watch:{selected:function(t){this.self_selected=t}},computed:{batteryColors:function(){return this.battery_level>.5?"#67C23A":this.battery_level>.2?"#E6A23C":"#F56C6C"},onlineStatus:function(){return"connected"==this.status?"已连接":"offline"==this.status?"离线":"在线"},taskStatus:function(){return 0==this.task_status?"空闲":2==this.task_status?"运行中":3==this.task_status?"暂停中":4==this.task_status?"任务完成":"异常"}},methods:{selectClick:function(){console.log("selectClick")}}}),y=v,_=(i("8f44"),Object(d["a"])(y,g,b,!1,null,"ecebe674",null)),x=_.exports,w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bot_item_extended"},[i("table",{staticClass:"info_area"},[i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("地位")]),i("td",{attrs:{width:"65%"}},["online"==t.status?i("span",[t._v(" 在线 ")]):"offline"==t.status?i("span",[t._v(" 离线 ")]):"connected"==t.status?i("span",[t._v(" 已连接 ")]):t._e()])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("状态")]),i("td",{attrs:{width:"65%"}},[0==t.task_status?i("span",[t._v(" 空闲 ")]):2==t.task_status?i("span",[t._v(" 运行中 ")]):3==t.task_status?i("span",[t._v(" 暂停中 ")]):4==t.task_status?i("span",[t._v(" 任务完成 ")]):t._e()])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("暂停")]),i("td",{attrs:{width:"65%"}},[3==t.task_status?i("span",[t._v(" 空闲 ")]):i("span",[t._v(" 否 ")])])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("电量")]),i("td",{attrs:{width:"65%"}},[t._v(" "+t._s(100*t.battery_level)+"% ")])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("当前站点")]),i("td",{attrs:{width:"65%"}},[t._v(t._s(t.current_station))])]),t._m(0),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("当前位置")]),i("td",{attrs:{width:"65%"}},[t._v(" "+t._s(t.x.toFixed(3))+" , "+t._s(t.y.toFixed(3))+" ")])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("角度(°)")]),i("td",{attrs:{width:"65%"}},[t._v(t._s((180*t.angle/Math.PI).toFixed(3)))])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("置信度")]),i("td",{attrs:{width:"65%"}},[t._v(" "+t._s(t.confidence.toFixed(3))+" ")])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("角速度(rad/s)")]),i("td",{attrs:{width:"65%"}},[t._v(t._s(t.w.toFixed(3)))])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("被阻挡")]),i("td",{attrs:{width:"65%"}},[1==t.blocked?i("span",[t._v(" 是 ")]):i("span",[t._v(" 否 ")])])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("电池温度(°C)")]),i("td",{attrs:{width:"65%"}},[t._v(t._s(t.battery_temp))])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("电池电压(V)")]),i("td",{attrs:{width:"65%"}},[t._v(t._s(t.voltage))])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("充电中")]),i("td",{attrs:{width:"65%"}},[1==t.charging?i("span",[t._v(" 是 ")]):i("span",[t._v(" 否 ")])])]),i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("急停")]),i("td",{attrs:{width:"65%"}},[1==t.emergency?i("span",[t._v(" 是 ")]):i("span",[t._v(" 否 ")])])]),t._m(1)])])},S=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("运单")]),i("td",{attrs:{width:"65%"}})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",{staticStyle:{height:"24px"}},[i("td",{attrs:{width:"35%"}},[t._v("模式")]),i("td",{attrs:{width:"65%"}},[t._v("调度模式")])])}],k={components:{},props:{status:{type:String,default:"offline"},current_status:{type:String,default:""},task_status:{type:Number,default:0},battery_level:{type:Number,default:0},current_station:{type:String,default:""},waybill:{type:String,default:""},x:{type:Number,default:0},y:{type:Number,default:0},angle:{type:Number,default:0},confidence:{type:Number,default:0},w:{type:Number,default:0},blocked:{type:Boolean,default:!1},battery_temp:{type:Number,default:0},voltage:{type:Number,default:0},charging:{type:Boolean,default:!1},emergency:{type:Boolean,default:!1},current_map:{type:String,default:""},current_ip:{type:String,default:"0.0.0.0"},vehicle_id:{type:String,default:""},MAC:{type:String,default:""},port:{type:Number,default:0},id:{type:String,default:""}},data:function(){return{selected:!1}},computed:{batteryColors:function(){return this.battery_level>.5?"#67C23A":this.battery_level>.2?"#E6A23C":"#F56C6C"}}},P=k,M=(i("d987"),Object(d["a"])(P,w,S,!1,null,"0fe39794",null)),C=M.exports,O={name:"Vehicles",data:function(){return{checked:!1,centerDialogVisible:!1,selectedIndex:0,currentBot:{},bots:[],selectedMap:new Map}},watch:{checked:function(t){var e=this;this.selectedMap.forEach((function(i,a){e.selectedMap.set(a,t)}))}},beforeDestroy:function(){console.log("beforeDestroy"),this.$socket.emit("vehicleData",{getDate:!1})},mounted:function(){this.$socket.emit("vehicleData",{getDate:!0})},sockets:{vehicleData:function(t){var e=this;console.log(t),this.bots=t;for(var i=new Map,a=0;a<this.bots.length;a++)i.set(this.bots[a].id,!0),this.selectedMap.has(this.bots[a].id)||this.selectedMap.set(this.bots[a].id,!1);this.selectedMap.forEach((function(t,a){i.get(a)||e.selectedMap.delete(a)})),console.log(this.selectedMap)}},methods:{pauseAll:function(t){this.$axios.post("/api/route/vehicles/pause",{},{params:{newValue:t}})},pauseSelect:function(t){var e=this;this.bots.forEach((function(i){1==e.selectedMap.get(i.id)&&e.$axios.post("/api/route/vehicles/"+i.vehicle_id+"/pause",{},{params:{newValue:t}})}))},withdrawSelect:function(){var t=this;this.bots.forEach((function(e){1==t.selectedMap.get(e.id)&&t.$axios.post("/api/route/vehicles/"+e.vehicle_id+"/withdrawal",{},{params:{immediate:!1,disableVehicle:!1}})}))},getSelected:function(t){var e=this.bots[t].id;return this.selectedMap.get(e)},cancelAutoUpdate:function(){console.log("cancelAutoUpdate"),clearTimeout(this.timer)},greet:function(t){console.log("greet"),this.centerDialogVisible=!0,this.currentBot=this.bots[t]},select:function(t){console.log("select "+t);var e=this.bots[t].id;this.selectedMap.set(e,!this.selectedMap.get(e)),this.$set(this.bots,t,this.bots[t])}},components:{BotItem:x,BotItemExtended:C}},L=O,N=(i("2964"),Object(d["a"])(L,f,m,!1,null,"71b9b7ee",null)),$=N.exports,z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"order_search_bar"},[i("span",[t._v("运单名称")]),i("el-input",{staticStyle:{width:"160px","margin-left":"4px"},attrs:{size:"mini"},model:{value:t.orderNameFilter,callback:function(e){t.orderNameFilter=e},expression:"orderNameFilter"}}),i("span",{staticStyle:{"margin-left":"10px"}},[t._v("预期机器人")]),i("el-input",{staticStyle:{width:"100px","margin-left":"4px"},attrs:{size:"mini"},model:{value:t.intendedVehicleFilter,callback:function(e){t.intendedVehicleFilter=e},expression:"intendedVehicleFilter"}}),i("span",{staticStyle:{"margin-left":"10px"}},[t._v("执行机器人")]),i("el-input",{staticStyle:{width:"100px","margin-left":"4px"},attrs:{size:"mini"},model:{value:t.processingVehicleFilter,callback:function(e){t.processingVehicleFilter=e},expression:"processingVehicleFilter"}}),i("span",{staticStyle:{"margin-left":"10px"}},[t._v("运单状态")]),i("el-select",{staticStyle:{width:"150px","margin-left":"4px"},attrs:{placeholder:"请选择",clearable:"",size:"mini"},model:{value:t.stateFilter,callback:function(e){t.stateFilter=e},expression:"stateFilter"}},t._l(t.stateOptions,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1),i("span",{staticStyle:{"margin-left":"10px"}},[t._v("运单类别")]),i("el-select",{staticStyle:{width:"100px","margin-left":"4px"},attrs:{placeholder:"请选择",clearable:"",size:"mini"},model:{value:t.categoryFilter,callback:function(e){t.categoryFilter=e},expression:"categoryFilter"}},t._l(t.categoryOptions,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:t.searchOrder}},[t._v("搜索")])],1),i("el-divider"),i("el-table",{ref:"orderTable",staticStyle:{width:"98%","margin-left":"1%"},attrs:{data:t.orderList,"cell-style":{background:"#373E4B",color:"#ffffff",textAlign:"center",fontSize:"10px"},"header-cell-style":{background:"#424a58",color:"#ffffff",textAlign:"center"},border:!0,size:"mini"},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"50"}}),i("el-table-column",{attrs:{prop:"name",label:"运单名称"}}),i("el-table-column",{attrs:{prop:"route",label:"路线"}}),i("el-table-column",{attrs:{prop:"intendedVehicle",width:"100",label:"预期机器人"}}),i("el-table-column",{attrs:{prop:"processingVehicle",width:"100",label:"执行机器人"}}),i("el-table-column",{attrs:{prop:"creationTime",width:"160",label:"创建时间"}}),i("el-table-column",{attrs:{prop:"state",width:"150",label:"运单状态"}}),i("el-table-column",{attrs:{prop:"category",width:"80",label:"运单类别"}})],1),i("div",{staticClass:"order_action_bar"},[i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini",disabled:t.hasSelectedOrder},on:{click:t.withdrawOrder}},[t._v("撤销运单")]),i("el-divider",{attrs:{direction:"vertical"}}),i("el-button",{attrs:{type:"text",size:"mini",disabled:1==t.currentPage},on:{click:t.lastPage}},[t._v("《")]),i("span",{staticStyle:{"margin-left":"6px"}},[t._v("第")]),i("el-input",{staticStyle:{width:"50px","margin-left":"3px","margin-right":"3px"},attrs:{type:"number",min:1,max:t.totalPage,size:"mini"},on:{change:t.currentPageChange},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}),i("span",[t._v("页")]),i("el-button",{staticStyle:{"margin-left":"6px"},attrs:{type:"text",size:"mini",disabled:t.currentPage==t.totalPage},on:{click:t.nextPage}},[t._v("》")]),i("span",{staticStyle:{"margin-left":"8px"}},[t._v("共 "+t._s(t.totalPage)+" 页 ")]),i("span",{staticStyle:{"margin-left":"8px"}},[t._v("每页")]),i("el-input",{staticStyle:{width:"50px","margin-left":"3px","margin-right":"3px"},attrs:{type:"number",min:1,size:"mini"},on:{change:t.pageSizeChange},model:{value:t.pageSize,callback:function(e){t.pageSize=e},expression:"pageSize"}}),i("span",[t._v("项")]),i("el-divider",{attrs:{direction:"vertical"}}),i("el-button",{attrs:{type:"success",size:"mini"},on:{click:t.exportFile}},[t._v("导出")])],1)],1)},F=[],E=(i("b0c0"),i("b3ba")),D={data:function(){return{stateList:[],orderNameFilter:"",intendedVehicleFilter:"",processingVehicleFilter:"",categoryFilter:"",stateFilter:"",orderList:[],stateOptions:["DISPATCHABLE","BEING_PROCESSED","WITHDRAWN","FINISHED","FAILED","UNROUTABLE"],categoryOptions:["Normal","Park","Charge"],selectedOrder:[],currentPage:1,totalPage:1,pageSize:20}},mounted:function(){this.searchOrder()},computed:{hasSelectedOrder:function(){return!(this.selectedOrder.length>0)}},watch:{},methods:{handleSelectionChange:function(t){this.selectedOrder=t},pageSizeChange:function(){this.searchOrder()},currentPageChange:function(){this.searchOrder()},withdrawOrder:function(){var t=this,e=this.selectedOrder.length;this.selectedOrder.forEach((function(i){t.$axios.post("/api/route/transportOrders/"+i.name+"/withdrawal").then((function(){e--,0==e&&t.searchOrder()})).catch((function(t){console.log("err=>",t)}))}))},lastPage:function(){this.currentPage--,this.searchOrder()},nextPage:function(){this.currentPage++,this.searchOrder()},searchOrder:function(){var t=this,e={};e.pageNo=this.currentPage,e.pageSize=this.pageSize,""!=this.intendedVehicleFilter&&(e.intendedVehicle=this.intendedVehicleFilter),""!=this.processingVehicleFilter&&(e.processingVehicle=this.processingVehicleFilter),""!=this.categoryFilter&&(e.category=this.categoryFilter),""!=this.stateFilter&&(e.state=this.stateFilter),this.$axios.get("/api/route/transportOrders",{params:e}).then((function(e){console.log(e.data),t.totalPage=e.data.total,t.refreashList(e.data.page)})).catch((function(t){console.log("err=>",t)}))},refreashList:function(t){var e=this;this.orderList=[],t.forEach((function(t){var i="";t.destinations.length>0&&(i=t.destinations[0].locationName);for(var a=1;a<t.destinations.length;a++)i+=" -> "+t.destinations[a].locationName;t.creationTime&&(t.creationTime=new Date(t.creationTime).toLocaleString()),e.orderList.push(Object.assign({},t,{route:i}))}))},exportFile:function(){Object(E["a"])(this.$refs.orderTable,{fileName:"export-demo-"+(new Date).getTime(),type:"xls"}).then((function(){console.log("ok")})).catch((function(t){console.log(t)}))}}},V=D,I=(i("c978"),Object(d["a"])(V,z,F,!1,null,null,null)),j=I.exports,T=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-container",{staticStyle:{height:"100vh"}},[i("el-header",[i("my-header")],1),i("el-container",{staticStyle:{height:"100%"}},[i("el-aside",{staticStyle:{background:"#424a58"},attrs:{width:"200px"}},[i("route-menu")],1),i("el-main",[i("router-view")],1)],1)],1)},B=[],A=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-menu",{staticStyle:{border:"0",height:"100%"},attrs:{"default-openeds":["1"],"default-active":"vehicles","background-color":"#424a58","text-color":"#dddddd","active-text-color":"#F7B902",router:""}},[i("el-submenu",{attrs:{index:"1"}},[i("template",{slot:"title"},[i("i",{staticClass:"el-icon-monitor"}),i("span",{staticClass:"submenu-title"},[t._v("常用")])]),i("el-menu-item",{attrs:{index:"vehicles"}},[i("i",{staticClass:"el-icon-menu"}),t._v("机器人")]),i("el-menu-item",{attrs:{index:"map"}},[i("i",{staticClass:"el-icon-map-location"}),t._v("场景")]),i("el-menu-item",{attrs:{index:"transportOrders"}},[i("i",{staticClass:"el-icon-s-order"}),t._v("运单")])],2),i("el-submenu",{attrs:{index:"2"}},[i("template",{slot:"title"},[i("i",{staticClass:"el-icon-document"}),i("span",{staticClass:"submenu-title"},[t._v("报告")])]),i("el-menu-item",{attrs:{index:"report"}},[i("i",{staticClass:"el-icon-document"}),t._v("报表")]),i("el-menu-item",{attrs:{index:"log"}},[i("i",{staticClass:"el-icon-document"}),t._v("操作日志")]),i("el-menu-item",{attrs:{index:"systemEvent"}},[i("i",{staticClass:"el-icon-document"}),t._v("系统事件")])],2),i("el-submenu",{attrs:{index:"3"}},[i("template",{slot:"title"},[i("i",{staticClass:"el-icon-user"}),i("span",{staticClass:"submenu-title"},[t._v("用户")])]),i("el-menu-item",{attrs:{index:"user"}},[i("i",{staticClass:"el-icon-user"}),t._v("用户")])],2)],1)},W=[],R={name:"RouteMenu",methods:{}},Y=R,X=(i("46f8"),Object(d["a"])(Y,A,W,!1,null,"16edd08e",null)),U=X.exports,H=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"my_header"},[i("span",{staticStyle:{"font-size":"32px","margin-left":"22px"}},[t._v("CRCS")]),i("div",[i("span",[t._v(t._s(t.user))]),i("el-button",{staticStyle:{"margin-left":"30px","margin-right":"30px"},attrs:{size:"mini",type:"primary"},on:{click:t.logout}},[t._v("登出")])],1)])},q=[],G={name:"app",components:{},data:function(){return{user:""}},methods:{logout:function(){window.location.href="/api/route/users/logout"}},mounted:function(){this.user=sessionStorage.getItem("user")}},J=G,K=(i("65b4"),Object(d["a"])(J,H,q,!1,null,"6dacf5d8",null)),Q=K.exports,Z={name:"app",components:{RouteMenu:U,MyHeader:Q},data:function(){return{}},methods:{},mounted:function(){}},tt=Z,et=(i("909d"),Object(d["a"])(tt,T,B,!1,null,"f12399e2",null)),it=et.exports,at=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"login_view"}},[i("div",{attrs:{id:"login_form"}},[i("p",{staticStyle:{"margin-top":"36px","font-size":"24px"}},[t._v("CRCS 登录")]),i("el-input",{staticStyle:{width:"250px","margin-top":"10px"},attrs:{placeholder:"请输入用户名"},model:{value:t.user,callback:function(e){t.user=e},expression:"user"}}),i("el-input",{staticStyle:{width:"250px","margin-top":"20px"},attrs:{placeholder:"请输入密码","show-password":""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),i("el-button",{staticStyle:{width:"160px","margin-top":"30px"},attrs:{type:"primary"},on:{click:t.login}},[t._v("登录")]),i("span",{staticStyle:{"margin-top":"10px",color:"#ee1111"}},[t._v(t._s(t.msg))])],1)])},st=[],nt={name:"Login",data:function(){return{user:"",password:"",msg:""}},methods:{login:function(){var t=this;this.msg="";var e={user:this.user,password:this.password};this.$axios.post("/api/route/users/login",e).then((function(e){console.log(e.data),0==e.data.ret_code?(sessionStorage.setItem("user",t.user),t.$router.push({name:"Index"})):t.msg=e.data.msg})).catch((function(t){console.log("err=>",t)}))}}},ot=nt,rt=(i("5331"),Object(d["a"])(ot,at,st,!1,null,"21ea9024",null)),lt=rt.exports,ct=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",[i("div",{staticStyle:{"margin-bottom":"20px"}},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogFormVisible=!0}}},[t._v("添加新用途")])],1),i("el-dialog",{attrs:{title:"User Registration",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{ref:"form",attrs:{model:t.formadd}},[i("el-form-item",{attrs:{label:"user name","label-width":t.formLabelWidth}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:t.formadd.name,callback:function(e){t.$set(t.formadd,"name",e)},expression:"formadd.name"}})],1),i("el-form-item",{attrs:{label:"Password","label-width":t.formLabelWidth}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:t.formadd.password,callback:function(e){t.$set(t.formadd,"password",e)},expression:"formadd.password"}})],1),i("el-form-item",{attrs:{label:"Role","label-width":t.formLabelWidth}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:t.formadd.role,callback:function(e){t.$set(t.formadd,"role",e)},expression:"formadd.role"}})],1),i("el-form-item",{attrs:{label:"Super Admin","label-width":t.formLabelWidth}},[i("el-switch",{model:{value:t.formadd.superadmin,callback:function(e){t.$set(t.formadd,"superadmin",e)},expression:"formadd.superadmin"}})],1),i("el-form-item",{attrs:{label:"Disabled","label-width":t.formLabelWidth}},[i("el-switch",{model:{value:t.formadd.disabled,callback:function(e){t.$set(t.formadd,"disabled",e)},expression:"formadd.disabled"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("Cancel")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("Confirm")])],1)],1),i("el-dialog",{attrs:{title:"User Registration",visible:t.dialogTableVisible},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[i("el-form",{ref:"formedit",attrs:{model:t.formedit}},[i("el-form-item",{attrs:{label:"user name","label-width":t.formLabelWidth}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:t.formedit.name,callback:function(e){t.$set(t.formedit,"name",e)},expression:"formedit.name"}})],1),i("el-form-item",{attrs:{label:"Password","label-width":t.formLabelWidth}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:t.formedit.password,callback:function(e){t.$set(t.formedit,"password",e)},expression:"formedit.password"}})],1),i("el-form-item",{attrs:{label:"Password","label-width":t.formLabelWidth}},[i("el-checkbox",{model:{value:t.formedit.chkdisabled,callback:function(e){t.$set(t.formedit,"chkdisabled",e)},expression:"formedit.chkdisabled"}},[t._v("Option")])],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogTableVisible=!1}}},[t._v("Cancel")]),i("el-button",[t._v("Save")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogTableVisible=!1}}},[t._v("Confirm")])],1)],1),i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{size:"mini","cell-style":{padding:"3px",height:"20px",background:"#373E4B",color:"#ffffff"},data:t.pagedTableData},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{label:"细节"}},[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("细节")])],1),i("el-table-column",{attrs:{prop:"username",label:"用户名"}}),i("el-table-column",{attrs:{prop:"superadmin",label:"超级管理员"}}),i("el-table-column",{attrs:{prop:"disabled",label:"残障人士"}}),i("el-table-column",{attrs:{prop:"created",label:"已创建"}}),i("el-table-column",{attrs:{property:"id",label:"ID"}}),i("el-table-column",{attrs:{property:"role",label:"角色"}})],1)],1),i("div"),i("el-divider"),i("div",{staticClass:"block"},[i("table",[i("tr",[i("td",[i("el-pagination",{attrs:{layout:"total,sizes,prev, pager, next,jumper",total:this.tableData.length,"page-sizes":[10,20,30,40],"page-size":10},on:{"current-change":t.setPage,"size-change":t.handleSizeChange}})],1),i("td")])])])],1)},dt=[],ut=(i("fb6a"),{data:function(){return{refreshswitch:!1,filterTextState:null,filterTextMac:null,filterTextName1:null,filterTextName2:null,inputtime:"",tableData:[{username:"admin1",superadmin:"T",disabled:"F",created:"07-19 21:28:10",id:"5dhua67210ujdq923490137",role:"admin"},{username:"admin1",superadmin:"T",disabled:"F",created:"07-19 21:28:10",id:"5dhua67210ujdq923490137",role:"admin"},{username:"admin1",superadmin:"T",disabled:"F",created:"07-19 21:28:10",id:"5dhua67210ujdq923490137",role:"admin"},{username:"admin1",superadmin:"T",disabled:"F",created:"07-19 21:28:10",id:"5dhua67210ujdq923490137",role:"admin"}],multipleSelection:[],page:1,pageSize:10,dialogTableVisible:!1,dialogFormVisible:!1,formadd:{name:"",password:"",superadmin:!0,role:"",disabled:!0},formedit:{name:"",delivery:!1},formLabelWidth:"120px"}},computed:{pagedTableData:function(){return this.tableData.slice(this.pageSize*this.page-this.pageSize,this.pageSize*this.page)}},methods:{setPage:function(t){this.page=t},handleSizeChange:function(t){console.log("".concat(t," items per page"))},toggleSelection:function(t){var e=this;t?t.forEach((function(t){e.$refs.multipleTable.toggleRowSelection(t)})):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(t){this.multipleSelection=t},filterTag:function(t,e){return e.state===t},filterHandler:function(t,e,i){var a=i["property"];return e[a]===t},methodThatForcesUpdate:function(){console.log("here"),this.$forceUpdate()}}}),ht=ut,pt=(i("b9a3"),Object(d["a"])(ht,ct,dt,!1,null,"717787e3",null)),ft=pt.exports,mt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"map_page"}},[i("div",{attrs:{id:"action_bar"}},[i("span",[t._v("场景地图："+t._s(t.header.mapName))]),i("el-divider",{attrs:{direction:"vertical"}}),i("el-button",{staticStyle:{"margin-left":"6px"},attrs:{type:"primary",size:"mini"},on:{click:t.mapManage}},[t._v("场景管理")]),i("el-divider",{attrs:{direction:"vertical"}}),i("el-upload",{attrs:{action:"http://localhost:30001/api/route/maps/test",name:"map","show-file-list":!1,"on-success":t.uploadSuccess,limit:1,accept:".smap"}},[i("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("上传地图")])],1)],1),i("el-divider"),i("div",{attrs:{id:"map_view"}},[i("svg",{staticStyle:{width:"98%",height:"98%",position:"absolute",top:"0",left:"0",border:"1px solid #cccccc","margin-left":"1%"},attrs:{id:"element_svg"}},[i("g",{attrs:{transform:"translate("+t.offsetX+","+(t.offsetY+(t.minYInMap+t.maxYInMap)*t.scale)+")scale("+t.scale/100+")"}},[i("g",t._l(t.advancedCurveList,(function(e,a){return i("path-line",t._b({key:e.instanceName+a,attrs:{active:t.selectedLineindex==a},on:{select:function(e){return t.selectLine(a)}},nativeOn:{contextmenu:function(e){return t.$emit("lineMenu",a)}}},"path-line",e,!1))})),1),i("g",t._l(t.advancedPointList,(function(e,a){return i("station",t._b({key:e.instanceName,attrs:{active:t.selectedStationindex==a},on:{select:function(e){return t.selectStation(a)},rbclick:function(e){return t.$emit("stationMenu",a)}}},"station",e,!1))})),1),i("g",t._l(t.routeList,(function(t){return i("route",{key:t.id,attrs:{route:t.route,index:t.id}})})),1),i("g",{directives:[{name:"show",rawName:"v-show",value:t.showAGV,expression:"showAGV"}]},t._l(t.botList,(function(e,a){return i("robot",t._b({key:e.id,nativeOn:{contextmenu:function(e){return t.$emit("robotMenu",a)}}},"robot",e,!1))})),1)])])]),i("el-dialog",{attrs:{title:"场景管理",visible:t.showMapManage},on:{"update:visible":function(e){t.showMapManage=e}}},[i("el-table",{attrs:{data:t.mapList,size:"mini",border:!0,"cell-style":{textAlign:"center"},"header-cell-style":{textAlign:"center"}}},[i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.current_filename==e.row.filename?i("span",[t._v("当前")]):i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return t.setMap(e.$index,e.row)}}},[t._v("激活")])]}}])}),i("el-table-column",{attrs:{property:"originalname",label:"场景名称"}}),i("el-table-column",{attrs:{property:"owner",label:"上传账号",width:"150"}}),i("el-table-column",{attrs:{property:"create_time",label:"上传时间",width:"150"}})],1)],1),i("el-dialog",{attrs:{visible:t.showInfo,"modal-append-to-body":!1,center:!0,width:"300px",top:"25vh"},on:{"update:visible":function(e){t.showInfo=e}}},t._l(t.info,(function(e){return i("div",{key:e.key,staticStyle:{display:"flex","align-items":"center","margin-top":"4px"}},[i("span",{staticStyle:{width:"80px","padding-left":"10px"}},[t._v(t._s(e.key))]),i("span",{staticStyle:{"padding-left":"8px",background:"#eeeeee",flex:"1",height:"30px","line-height":"30px",display:"block"}},[t._v(t._s(e.value))])])})),0)],1)},gt=[],bt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("g",{attrs:{transform:"translate("+100*t.pos.x+","+100*-t.pos.y+")"}},[i("g",{class:{station_active:t.active,station:!t.active},style:{cursor:t.mouseStyle},on:{click:function(e){return e.stopPropagation(),t.$emit("select")},mousedown:function(e){return t.$emit("mouse_down")},mouseover:function(e){return t.$emit("mouse_over")},contextmenu:function(e){return t.$emit("rbclick")}}},[i("circle",{class:t.className,staticStyle:{"stroke-width":"2px"},style:{stroke:t.strokeColor},attrs:{r:20}}),i("text",{staticStyle:{"dominant-baseline":"middle","text-anchor":"middle"},attrs:{y:-35,fill:"#eeeeee","font-size":"28"}},[t._v(t._s(t.instanceName))]),i("title",[t._v(t._s(t.instanceName))])])])},vt=[],yt={components:{},props:{className:{type:String,default:""},instanceName:{type:String,default:""},pos:{type:Object},dir:{type:Number},botWidth:{type:Number,default:.73},botLength:{type:Number,default:1.05},active:{type:Boolean,default:!1},editMode:{type:String,default:"normal"}},data:function(){return{}},computed:{bArrow:function(){return"undefined"!=typeof this.dir},botRotate:function(){return console.log(this.bArrow),this.dir?"rotate("+180*-this.dir/Math.PI+")":""},botRidus:function(){return Math.sqrt(this.botWidth*this.botWidth+this.botLength*this.botLength)/2},arrowPath:function(){return"M"+(50*this.botLength-4)+",0 l-12,-7 l0,14 z"},mouseStyle:function(){return"addStation"==this.editMode||"addLine"==this.editMode?"crosshair":"erase"==this.editMode?"none":"pointer"},strokeColor:function(){return this.active?"#F7B902":"#75923C"}},methods:{}},_t=yt,xt=(i("accf"),Object(d["a"])(_t,bt,vt,!1,null,"b602ff32",null)),wt=xt.exports,St=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("g",[i("path",{class:{path_active:t.active,path:!t.active},style:{cursor:t.mouseStyle},attrs:{d:t.pathString},on:{click:function(e){return e.stopPropagation(),t.$emit("select")}}}),i("rect",{directives:[{name:"show",rawName:"v-show",value:t.active&&"BezierPath"==t.className,expression:"active && className == 'BezierPath'"}],attrs:{x:100*t.controlPos1.x-5,y:100*-t.controlPos1.y-5,width:"10",height:"10",fill:"#dd0000",id:t.instanceName+"_1"}}),i("rect",{directives:[{name:"show",rawName:"v-show",value:t.active&&"BezierPath"==t.className,expression:"active && className == 'BezierPath'"}],attrs:{x:100*t.controlPos2.x-5,y:100*-t.controlPos2.y-5,width:"10",height:"10",fill:"#dd0000",id:t.instanceName+"_2"}}),i("title",[t._v(t._s(t.instanceName))])])},kt=[],Pt={components:{},props:{className:{type:String,default:""},instanceName:{type:String,default:""},startPos:{type:Object},endPos:{type:Object},controlPos1:{type:Object,default:function(){return{x:0,y:0}}},controlPos2:{type:Object,default:function(){return{x:0,y:0}}},yOffset:{type:Number,default:0},active:{type:Boolean,default:!1},editMode:{type:String,default:"normal"}},data:function(){return{}},mounted:function(){},watch:{},computed:{pathString:function(){var t="M "+100*this.startPos.pos.x+","+100*-this.startPos.pos.y;return"BezierPath"==this.className?t+=" C "+100*this.controlPos1.x+","+100*-this.controlPos1.y+" "+100*this.controlPos2.x+","+100*-this.controlPos2.y+" "+100*this.endPos.pos.x+","+100*-this.endPos.pos.y:t+=" L"+100*this.endPos.pos.x+","+100*-this.endPos.pos.y,t},centerX:function(){return"BezierPath"==this.className?100*(.125*this.startPos.pos.x+.375*this.controlPos1.x+.375*this.controlPos2.x+.125*this.endPos.pos.x):50*(this.endPos.pos.x+this.startPos.pos.x)},centerY:function(){return"BezierPath"==this.className?-100*(.125*this.startPos.pos.y+.375*this.controlPos1.y+.375*this.controlPos2.y+.125*this.endPos.pos.y):-50*(this.endPos.pos.y+this.startPos.pos.y)},arrowAngle:function(){var t=0,e=0;if("BezierPath"==this.className){var i=100*(.110592*this.startPos.pos.x+.359424*this.controlPos1.x+.389376*this.controlPos2.x+.140608*this.endPos.pos.x),a=-100*(.110592*this.startPos.pos.y+.359424*this.controlPos1.y+.389376*this.controlPos2.y+.140608*this.endPos.pos.y);t=i-this.centerX,e=a-this.centerY}else t=this.endPos.pos.x-this.startPos.pos.x,e=this.startPos.pos.y-this.endPos.pos.y;var s=180*Math.atan(e/t)/Math.PI;return t<0&&(s+=180),s},arrowString:function(){return"M "+this.centerX+","+this.centerY+"l0,-10 l30,10 l-30,10 z"},mouseStyle:function(){return"erase"==this.editMode?"none":"pointer"}},methods:{}},Mt=Pt,Ct=(i("4b05"),Object(d["a"])(Mt,St,kt,!1,null,"8191ba24",null)),Ot=Ct.exports,Lt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("g",{attrs:{transform:"translate("+100*t.x+","+100*-t.y+")"},on:{click:function(e){return e.stopPropagation(),t.$emit("select")}}},[i("g",{attrs:{transform:t.botRotate}},[i("rect",{class:t.active?"bot_shape_active":"bot_shape",attrs:{x:50*-t.botLength,y:50*-t.botWidth,width:100*t.botLength,height:100*t.botWidth}}),i("path",{attrs:{fill:"red",stroke:"red",d:t.arrowPath}})]),i("title",[t._v(t._s(t.vehicle_id))])])},Nt=[],$t={components:{},props:{vehicle_id:{type:String,default:""},x:{type:Number,default:0},y:{type:Number,default:0},angle:{type:Number,default:0},botWidth:{type:Number,default:.4},botLength:{type:Number,default:.6},active:{type:Boolean,default:!1}},data:function(){return{}},computed:{botRotate:function(){return"rotate("+180*-this.angle/Math.PI+")"},arrowPath:function(){return"M"+(50*this.botLength-4)+",0 l-12,-7 l0,14 z"}},methods:{test:function(){console.log("test")}}},zt=$t,Ft=(i("8400"),Object(d["a"])(zt,Lt,Nt,!1,null,"213d61d2",null)),Et=Ft.exports,Dt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("g",[i("path",{staticClass:"path",style:{stroke:t.lineColor},attrs:{d:t.pathString,"stroke-dasharray":"15,10"}})])},Vt=[],It={components:{},props:{route:{type:Array},index:{type:Number}},data:function(){return{colorlist:["#ee0000","#00ee00","#0000ee","#eeee00","#00eeee","#ee00ee","#0073ee","#73ee00","#7300ee","#ee7300"]}},mounted:function(){},watch:{},computed:{pathString:function(){var t="M "+100*this.route[0].x+","+100*-this.route[0].y;t+=" L"+100*this.route[1].x+","+100*-this.route[1].y;for(var e=2;e<this.route.length;e++)t+=" L"+100*this.route[e].x+","+100*-this.route[e].y;return console.log(t),t},lineColor:function(){var t=this.index%10;return this.colorlist[t]}},methods:{}},jt=It,Tt=(i("5c7f"),Object(d["a"])(jt,Dt,Vt,!1,null,"3976717e",null)),Bt=Tt.exports,At={components:{Station:wt,PathLine:Ot,Robot:Et,Route:Bt},props:{},data:function(){return{botList:[],routeList:[],mapList:[],advancedPointList:[],stationMap:new Map,advancedCurveList:[],header:{},smap:{},scale:10,offsetX:0,offsetY:0,minYInMap:0,maxYInMap:0,pictureUrl:"/img/",showAGV:!0,showMapManage:!1,showInfo:!1,info:[],selectedLineindex:-1,selectedStationindex:-1,current_filename:""}},watch:{header:function(t){console.log("header change"),this.maxWidthInMap=t.maxPos.x-t.minPos.x,this.maxHeightInMap=t.maxPos.y-t.minPos.y,this.minYInMap=t.minPos.y,this.maxYInMap=t.maxPos.y,this.updateScale(),this.offsetX=Math.round(-t.minPos.x*this.scale),this.offsetY=Math.round(-t.minPos.y*this.scale)}},computed:{},created:function(){},beforeDestroy:function(){console.log("beforeDestroy"),this.$socket.emit("vehicleData",{getDate:!1}),this.$socket.emit("RouteDate",{getDate:!1})},mounted:function(){var t=this;this.getCurrentMap(),this.$socket.emit("vehicleData",{getDate:!0}),this.$socket.emit("RouteDate",{getDate:!0}),this.mapview=document.getElementById("map_view"),this.svg=document.getElementById("element_svg"),this.svg.onmousewheel=this.mouseWheel,this.svg.onmousedown=function(e){1==e.buttons&&(t.moved=!1,t.svg.onmousemove=function(e){t.moved=!0,t.offsetX+=e.movementX,t.offsetY+=e.movementY},t.svg.onmouseup=function(){t.svg.onmousemove=null,t.svg.onmouseup=null})}},sockets:{vehicleData:function(t){var e=this;console.log(t),this.botList=[],t.forEach((function(t){"connected"==t.status&&e.botList.push(t)}))},RouteDate:function(t){console.log(t),this.routeList=[];for(var e=0;e<t.length;e++){for(var i=[],a=0,s=0;s<this.botList.length;s++)if(this.botList[s].vehicle_id==t[e].vehicle_id){a=s;break}var n={id:a,route:i};i.push(this.stationMap.get(t[e].route[0].start)),i.push(this.stationMap.get(t[e].route[0].end));for(var o=1;o<t[e].route.length;o++)i.push(this.stationMap.get(t[e].route[o].end));this.routeList.push(n)}console.log(this.routeList)}},methods:{getCurrentMap:function(){var t=this;this.$axios.get("/api/route/maps/current").then((function(e){t.advancedPointList=e.data.advancedPointList,t.advancedCurveList=e.data.advancedCurveList,t.header=e.data.header,t.stationMap.clear(),t.advancedPointList.forEach((function(e){t.stationMap.set(e.instanceName,e.pos)})),console.log(t.stationMap)})).catch((function(t){console.log("err=>",t)}))},uploadSuccess:function(){this.$message({message:"地图文件上传成功！",type:"success"})},setMap:function(t,e){var i=this;console.log(t),console.log(e),this.$axios.put("/api/route/maps/current",{filename:e.filename}).then((function(){i.mapManage(),i.getCurrentMap()}))},mapManage:function(){var t=this;this.$axios.get("/api/route/maps/current/filename").then((function(e){console.log(e.data),t.current_filename=e.data})).catch((function(t){console.log("err=>",t)})),this.$axios.get("/api/route/maps").then((function(e){console.log(e.data),t.mapList=e.data,t.showMapManage=!0})).catch((function(t){console.log("err=>",t)}))},mouseWheel:function(t){t.wheelDelta>0?this.scaleUp(t.offsetX,t.offsetY):this.scaleDown(t.offsetX,t.offsetY)},scaleUp:function(t,e){if(400!=this.scale){var i=this.scale;this.scale<10?this.scale+=2:this.scale<20?this.scale+=5:this.scale<100?this.scale+=10:this.scale<200?this.scale+=20:this.scale+=50,console.log(this.scale);var a=this.scale/i;this.offsetX=t+a*(this.offsetX-t),this.offsetY=e+a*(this.offsetY-e)}},scaleDown:function(t,e){if(2!=this.scale){var i=this.scale;this.scale>200?this.scale-=50:this.scale>100?this.scale-=20:this.scale>20?this.scale-=10:this.scale>10?this.scale-=5:this.scale-=2,console.log(this.scale);var a=this.scale/i;this.offsetX=t+a*(this.offsetX-t),this.offsetY=e+a*(this.offsetY-e)}},updateScale:function(){console.log(this.mapview);var t=this.mapview.clientWidth/this.maxWidthInMap,e=this.mapview.clientHeight/this.maxHeightInMap;console.log(t),console.log(e);var i=Math.min(t,e);console.log(i),this.scale=i>10?10*Math.round(i/10):2*Math.round(i/2),console.log("updateScale "+this.scale)},selectStation:function(t){console.log(t),this.selectedStationindex=t;var e=[],i={key:"站点",value:this.advancedPointList[this.selectedStationindex].instanceName};e.push(i),i={key:"X",value:this.advancedPointList[this.selectedStationindex].pos.x},e.push(i),i={key:"Y",value:this.advancedPointList[this.selectedStationindex].pos.y},e.push(i),this.info=e,this.showInfo=!0},selectLine:function(t){console.log(t),this.selectedLineindex=t,this.showInfo=!0}}},Wt=At,Rt=(i("4ef9"),Object(d["a"])(Wt,mt,gt,!1,null,"cd09ca3e",null)),Yt=Rt.exports;a["default"].use(p["a"]);var Xt=[{path:"/",name:"Index",component:it,redirect:"/vehicles",children:[{path:"vehicles",component:$},{path:"/transportOrders",name:"TransportOrders",component:j},{path:"/users",name:"Users",component:ft},{path:"/map",name:"Map",component:Yt}]},{path:"/loginPage",name:"Login",component:lt}],Ut=new p["a"]({mode:"history",base:"/",routes:Xt}),Ht=Ut,qt=i("2f62");a["default"].use(qt["a"]);var Gt=new qt["a"].Store({state:{},mutations:{},actions:{},modules:{}}),Jt=i("5132"),Kt=i.n(Jt),Qt=i("daa8"),Zt=i("5c96"),te=i.n(Zt);i("0fae");a["default"].use(te.a),a["default"].config.productionTip=!1,a["default"].prototype.$axios=n.a,Ht.beforeEach((function(t,e,i){document.title="CRCS",i()})),n.a.get("/api/route/utils/wshost").then((function(t){console.log(t.data),a["default"].use(new Kt.a({debug:!0,connection:Object(Qt["a"])(t.data)})),new a["default"]({router:Ht,store:Gt,render:function(t){return t(h)}}).$mount("#app")}))},5803:function(t,e,i){},"5c7f":function(t,e,i){"use strict";i("5803")},6331:function(t,e,i){},"65b4":function(t,e,i){"use strict";i("b97b")},"79cd":function(t,e,i){},8400:function(t,e,i){"use strict";i("c9c6")},"85ec":function(t,e,i){},"88b3":function(t,e,i){},"8f44":function(t,e,i){"use strict";i("98f7")},"909d":function(t,e,i){"use strict";i("88b3")},"98f7":function(t,e,i){},accf:function(t,e,i){"use strict";i("f69d")},b6e1:function(t,e,i){},b8f2:function(t,e,i){},b97b:function(t,e,i){},b9a3:function(t,e,i){"use strict";i("6331")},c732:function(t,e,i){},c978:function(t,e,i){"use strict";i("b8f2")},c9c6:function(t,e,i){},ca91:function(t,e,i){},d987:function(t,e,i){"use strict";i("1208")},e864:function(t,e,i){},f69d:function(t,e,i){}});
//# sourceMappingURL=app.b60bea03.js.map